
# â­ **GPO Ekspluatatsiyasi orqali Lateral Movement â€” Oâ€˜zbekcha tarjima**

Biz foydalanuvchi keylogging orqali credential bazani ochdik va juda muhim boâ€˜lgan **svcServMan** hisobining parollarini qoâ€˜lga kiritdik. Endi bu parollar bizga AD ekspluatatsiyasini yanada chuqurlashtirishda qanday yordam berishini aniqlashimiz kerak.

Yaxshiyamki, bizda oldindan toâ€˜plangan **Sharphound (BloodHound)** maâ€™lumotlari mavjud.

Qidiruv orqali svcServMan hisobining huquqlarini tekshiramiz.

---

# ğŸ” **BloodHound orqali svcServMan huquqlari**

BloodHound natijasida bir huquq juda ajralib turadi â€” bu hisob:

â¡ï¸ **bitta Group Policy Object (GPO) ga egalik qiladi.**

Yana tekshirganda koâ€˜ramizki:

â¡ï¸ Ushbu GPO **THMSERVER2** mashinasiga qoâ€˜llanadi.

Bu bizga **AD ichidagi huquqlarni oâ€˜zgartirish orqali lateral movement qilish imkoniyatini beradi.**

---

# ğŸ› **Group Policy Objects nima edi?**

Enumerating AD boâ€˜limida aytilganidek:

* AD ichidagi GPOâ€™lar **SYSVOL** katalogida saqlanadi.
* Har bir GPO noyob **GUID** bilan belgilanadi.
* SYSVOL ni oâ€˜qiganda koâ€˜pchilik kataloglar tartibsiz koâ€˜rinadi â€” bu GUIDâ€™lar sababli.

Har bir Windows kompyuterining **Local Policy Configuration** mavjud.

U yerda quyidagi sozlamalar boâ€˜ladi:

* Firewall, Antivirus, Applocker konfiguratsiyasi
* Local Administrators, Remote Desktop Users kabi guruhlar
* Startup skriptlar
* Protokol xavfsizligi (masalan SMBv1 yoqilgan/yoqilmagan)

Va yana oâ€˜nlab boshqa sozlamalarâ€¦

---

# ğŸ¢ **Group Policy Management nima?**

Agar faqat bitta Windows kompyuter boâ€˜lsa â€” lokal policy yetarli.

Ammo **korporativ tarmoqlar**da yuzlab mashinalar bor. Ularga birdaniga politika yuborish kerak.

GPM (Group Policy Management):

* AD tuzilmasi boâ€˜yicha siyosatlarni belgilaydi
* GPOâ€™larni OU, guruh yoki domen darajasiga qoâ€˜llaydi
* Mashinalar har 15 daqiqada SYSVOLâ€™dagi siyosatlarni tortib oladi (gpupdate)

Qoâ€˜l bilan darhol yangilash ham mumkin:

```
gpupdate /force
```

---

# ğŸ’¥ **GPO Ekspluatatsiyasi**

GPOâ€™dan turli yoâ€˜llar bilan foydalanish mumkin.

Biz **eng sodda va samarali** ekspluatatsiya usulini ishlatamiz:

â¡ï¸ **Oâ€˜zimizga tegishli AD hisobini THMSERVER2 kompyuteridagi Local Administrators va Remote Desktop Users guruhlariga qoâ€˜shamiz.**

Bu bizga:

* THMSERVER2 ustidan toâ€˜liq administratorlik
* RDP orqali unda sessiya ochish

huquqini beradi.

SSH ham boâ€˜lishi mumkin, lekin koâ€˜p tashkilotlarda mavjud emas.

---

# ğŸ§‘â€ğŸ’» **GPOâ€™ni oâ€˜zgartirish uchun AD hisobini ishlatish**

Biz svcServMan hisobida GPOâ€™ni oâ€˜zgartirishimiz mumkin. Ammo THMSERVER1 ga shu foydalanuvchi bilan RDP qilish:

âŒ Foydalanuvchini sessiyadan chiqarib yuborishi mumkin
âŒ Shubha uygâ€˜otadi

Shuning uchun:

1. THMWRK1 ga odatiy yoki Tier 2 admin hisobingiz bilan RDP qilasiz
2. svcServMan hisobini **runas /netonly** bilan jarayonga yuklaysiz
3. shu jarayon ichidan **mmc** ochib, GPOâ€™ni tahrirlaysiz

---

# ğŸ”‘ **runas orqali AD credentiallarni xotiraga yuklash**

Administrator cmd oynasida:

```
runas /netonly /user:za.tryhackme.loc\<AD Username> cmd.exe
```

Parolni kiriting.

Toâ€˜gâ€˜ri ishlaganini tekshirish:

```
dir \\za.tryhackme.loc\sysvol
```

Agar SYSVOL ochilsa â€” credentiallar muvaffaqiyatli yuklandi.

---

# ğŸªŸ **MMC ishga tushirish**

Yangi cmd oynasida:

```
mmc
```

Keyin:

* File â†’ Add/Remove Snap-in
* Group Policy Management â†’ Add
* OK

Endi barcha domen GPOâ€™lari koâ€˜rinadi.

---

# ğŸ§­ **Kerakli GPOâ€™ga oâ€˜tish**

GPO yoâ€˜li (masalan):

```
Servers â†’ Management Servers â†’ Management Server Pushes
```

Uni oâ€˜ng bosib â†’ **Edit**.

---

# ğŸ›  **Bizning hisobni Local Administrators va RDP Users guruhlariga qoâ€˜shish**

GPO Editor ichida:

1. Computer Configuration
2. Policies
3. Windows Settings
4. Security Settings
5. **Restricted Groups**
6. Oâ€˜ng bosib â€œAdd Groupâ€

Guruh nomi:

```
IT Support
```

(Misol boâ€˜yicha shu guruh ekspluatatsiya uchun ishlatiladi)

Keyin:

* â€œMembers of this groupâ€ â†’ bu yerga **Administrators** va **Remote Desktop Users** guruhlarini qoâ€˜shamiz

Yakuniy koâ€˜rinishi shunday boâ€˜ladi:

(Admin + RDP Users qoâ€˜shilgan)

---

# â³ **GPO qoâ€˜llanishini kutish**

Default: **15 daqiqa**

Shundan soâ€˜ng:

â¡ï¸ IT Support guruhida boâ€˜lgan bizning foydalanuvchi **THMSERVER2 da administrator** boâ€˜ladi
â¡ï¸ **RDP orqali THMSERVER2 ga kira olamiz**

---

# ğŸ‰ Natija

Biz quyidagilarni qoâ€˜lga kiritdik:

* svcServMan hisobining real kuchi
* GPO huquqlari orqali lateral movement
* THMSERVER2 ustidan administratorlik
* RDP orqali tizimga kirish
* Tarmoqqa yanada chuqurroq joylashish

AD ekspluatatsiyasining kuchli usullaridan biri â€” **GPO takeover** muvaffaqiyatli amalga oshirildi.
